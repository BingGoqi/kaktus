#include "delaunator.hpp"
#include <cstdio>

int main() {
    FILE* fout;
    fopen_s(&fout, "out2.stl", "w");
    /* x0, y0, x1, y1, ... */
    std::vector<double> coords;
    float f;
    for (int i = 0; i < 628; i++)
    {
        f = i;
        f /= 100;
        coords.push_back(cos(f));
        coords.push_back(sin(f));
    }
        //{ 0.386129,0.473541,0.492096,0.612182,0.563229,0.437516,0.415206,0.560085,0.512078,0.347852,0.654438,0.581137,0.692866,0.476551,0.478871,0.480133,0.250880,0.553852,0.425249,0.345769,0.275861,0.406352,0.324331,0.328491,0.409591,0.747733,0.506753,0.694795,0.380080,0.661938,0.605345,0.363214,0.298083,0.649033,0.637970,0.258759,0.485906,0.271783,0.656254,0.671362,0.776427,0.592234,0.797657,0.380377,0.130307,0.572520,0.196598,0.674766,0.192982,0.493030,0.429187,0.194345,0.207495,0.356222,0.245714,0.281706,0.306550,0.177934,0.272277,0.812247,0.527275,0.832953,0.363108,0.879190,0.618773,0.761712,0.706869,0.310140,0.550048,0.218316,0.610491,0.115822,0.749229,0.228659,0.717825,0.133332,0.768059,0.683080,0.869993,0.467472,0.856401,0.608255,0.903352,0.543048,0.926273,0.391197,0.859932,0.237914,0.132821,0.430245,0.011749,0.602092,0.112218,0.695201,0.200701,0.766040,0.278200,0.728240,0.301407,0.484288,0.442865,0.093011,0.350919,0.101180,0.053961,0.320168,0.130185,0.223718,0.383850,0.269293,0.255660,0.096475,0.320686,0.947455,0.520229,0.915526,0.641513,0.885839,0.431432,0.824792,0.220340,0.890400,0.433754,0.935313,0.705223,0.779806,0.520287,0.141595,0.548423,0.008562,0.675791,0.051746,0.820105,0.163080,0.760363,0.044607,0.790147,0.820278,0.860542,0.690563,0.876431,0.325377,0.983782,0.462437,0.956291,0.703342,0.970474,0.605140,0.791821,0.511629,0.960108,0.277801,0.956916,0.186140,0.869440,0.092684,0.034293,0.513870,0.036789,0.777766,0.097241,0.881597,0.392269,0.020316,0.244121,0.010048,0.009440,0.166911,0.005480,0.430548,0.115549,0.082492,0.172727,0.143675,0.235447,0.972731,0.586846,0.976182,0.699556,0.941635,0.803602,0.916387,0.867103,0.860025,0.924770,0.799161,0.955075,0.056640,0.005388,0.690809,0.129914,0.997132,0.019233,0.937918,0.014255,0.026620,0.793811,0.999618,0.901022,0.937251,0.983060,0.964576,0.990400,0.847502 };

    //triangulation happens here
    delaunator::Delaunator d(coords);

    for (std::size_t i = 0; i < d.triangles.size(); i += 3) {
        fprintf(fout,"facet normal %f %f %f\nouter loop\nvertex %f %f %f\nvertex %f %f %f\nvertex %f %f %f\nendloop\nendfacet\n",
            0., 0., 0.,
            d.coords[2 * d.triangles[i]], d.coords[2 * d.triangles[i] + 1], i / 100.,
            d.coords[2 * d.triangles[i + 1]], d.coords[2 * d.triangles[i + 1] + 1], i / 100.,
            d.coords[2 * d.triangles[i + 2]], d.coords[2 * d.triangles[i + 2] + 1], i / 100.);
    }
}